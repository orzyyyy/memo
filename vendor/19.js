(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1509:function(e,t,a){"use strict";a.r(t);var r=a(81),n=a.n(r),l=a(90),u=a.n(l),o=a(2),i=a.n(o),s=a(0),c=a.n(s),m=a(1486),p=a(1489),h=a(1485),g=a(1511),v=a(1487),d=a(1490),f=a(1492),y=a(1504),x=a(1513),C=a(1497),b=a(1498),E=a(70),k=a(1514),T=a(1499),w=a(1496),S=a(1328),O=a.n(S),j=a(1327),B=a.n(j),I=a(1326),F=a.n(I),V=a(67),L=a(72),N=a(1506),W=a(1484),q=Object(V.a)((function(e){return Object(L.a)({container:{display:"flex",flexWrap:"wrap"},root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},formControl:{margin:e.spacing(1)},title:{flexGrow:1},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-50},buttonSuccess:{backgroundColor:W.a[500],"&:hover":{backgroundColor:W.a[700]}},success:{backgroundColor:W.a[600]},failed:{backgroundColor:e.palette.error.dark},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}})})),D=function(e){var t=e.key,a=e.error,r=e.inputLabel,n=e.inputValue,l=e.helperText,u=e.xs,o=e.unit,i=void 0===o?"mm":o,s=e.readOnly,p=void 0!==s&&s,y=e.required,x=void 0===y||y,C=e.onChange,b=e.onBlur,E=e.classes,k=e.shrink,T=void 0!==k&&k;return c.a.createElement(h.a,{item:!0,xs:u,key:t},c.a.createElement(m.a,{required:x,className:E.formControl,error:a},c.a.createElement(g.a,{shrink:T||!!n},r),c.a.createElement(v.a,{value:n,type:"number",onChange:function(e){return C(e,t)},onBlur:b,endAdornment:c.a.createElement(d.a,{position:"end"},i),readOnly:p}),c.a.createElement(f.a,null,l)))},P=function(e){var t=e.formOptions,a=e.formData,r=e.classes,n=e.handleSelectChange,l=e.handleAutocompleteChange,o=e.handleInputChange,i=e.onSpecificationInputBlur,s=function(e,t){var a=parseInt(""+t.materialType.value);return e.filter((function(e){return 0===a?!t.length.value||t.length.value==e.length:1===a?t.length.value&&t.width.value?t.length.value==e.length&&t.width.value==e.width:t.width.value?t.width.value==e.width:!t.length.value||t.length.value==e.length:void 0}))}(t.materialId,a),p=parseInt(""+a.materialType.value);return c.a.createElement(c.a.Fragment,null,c.a.createElement(h.a,{item:!0,xs:6},c.a.createElement(m.a,{required:!0,fullWidth:!0,className:r.formControl,error:a.materialType.error},c.a.createElement(g.a,{shrink:-1!==a.materialType.value},"类别"),c.a.createElement(y.a,{value:a.materialType.value,onChange:function(e){return n(e,"materialType")}},t.materialType.map((function(e){var t=e.text,a=e.value;return c.a.createElement(x.a,{value:a,key:t+"-"+a},t)}))))),c.a.createElement(h.a,{item:!0,xs:6},c.a.createElement(m.a,{required:!0,fullWidth:!0,className:r.formControl,error:a.sellType.error},c.a.createElement(g.a,{shrink:-1!==a.sellType.value},"卖出类型"),c.a.createElement(y.a,{value:a.sellType.value,onChange:function(e){return n(e,"sellType")}},t.sellType.map((function(e){var t=e.text,a=e.value;return c.a.createElement(x.a,{value:a,key:t+"-"+a},t)}))))),function(e){var t=e.handleInputChange,a=e.formData,r=e.onSpecificationInputBlur,n=e.classes;switch(parseInt(a.materialType.value+"")){case 0:return c.a.createElement(c.a.Fragment,null,D({key:"length",error:a.length.error,inputLabel:"截面直径",inputValue:a.length.value,helperText:a.length.message,xs:6,onChange:t,onBlur:r,classes:n}));case 1:return c.a.createElement(c.a.Fragment,null,D({key:"length",error:a.length.error,inputLabel:"截面长度",inputValue:a.length.value,helperText:a.length.message,xs:6,onChange:t,onBlur:r,classes:n}),D({key:"width",error:a.width.error,inputLabel:"截面宽度",inputValue:a.width.value,helperText:a.width.message,xs:6,onChange:t,onBlur:r,classes:n}));default:return null}}({handleInputChange:o,formData:a,onSpecificationInputBlur:i,classes:r}),0===p&&c.a.createElement(h.a,{item:!0,xs:6,key:"roundType"},c.a.createElement(m.a,{required:!0,fullWidth:!0,className:r.formControl,error:a.round.error},c.a.createElement(g.a,{shrink:-1!==a.round.value},"圆钢类别"),c.a.createElement(y.a,{value:a.round.value,onChange:function(e){return n(e,"roundType")}},t.roundType.map((function(e){var t=e.text,a=e.value;return c.a.createElement(x.a,{value:a,key:t+"-"+a},t)}))))),c.a.createElement(m.a,{fullWidth:!0,error:a.materialId.error,className:r.formControl},c.a.createElement(N.a,{options:s,getOptionLabel:function(e){return e.text},value:a.materialId.value,onChange:l,id:"material-id","aria-controls":"material-id",renderInput:function(e){return c.a.createElement(C.a,u()({},e,{fullWidth:!0,margin:"normal",required:!0,label:"材质",error:a.materialId.error}))}}),c.a.createElement(f.a,null,a.materialId.message)))},Q=function(e){var t=e.classes,a=e.onSubmit,r=e.loading;return c.a.createElement(m.a,{fullWidth:!0,className:t.formControl},c.a.createElement(b.a,{variant:"contained",color:"primary",disabled:r,onClick:a},"保存"),r&&c.a.createElement(E.a,{size:24,className:t.buttonProgress}))},A=function(e){var t=e.type,a=e.message,r=e.open,n=e.onClose,l=q();return c.a.createElement(k.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:r},c.a.createElement(T.a,{className:l[t],message:c.a.createElement("span",{className:l.message},"success"===t?c.a.createElement(F.a,{className:l.iconVariant}):c.a.createElement(B.a,{className:l.iconVariant}),c.a.createElement("span",null,a)),action:[c.a.createElement(w.a,{key:"close","aria-label":"close",color:"inherit",onClick:n},c.a.createElement(O.a,{className:l.icon}))]}))},z=function(e){var t=e.onSubmit,a=e.formData,r=e.onChange,n=e.onSpecificationInputBlur,l=e.formOptions,u=e.loading,o=q(),i=function(e,t){r({text:e.target.value,value:e.target.value},"input",t)};return c.a.createElement("div",{className:o.container},P({formOptions:l,formData:a,classes:o,handleSelectChange:function(e,t){r({text:"",value:e.target.value},"select",t)},handleAutocompleteChange:function(e,t){r(t,"autoComplete")},handleInputChange:i,onSpecificationInputBlur:n}),D({key:"weight",error:a.weight.error,inputLabel:"实际重量",inputValue:a.weight.value,helperText:a.weight.message,xs:6,unit:"kg",onChange:i,onBlur:n,classes:o}),D({key:"height",error:a.height.error,inputLabel:"高度",inputValue:a.height.value,helperText:a.height.message,xs:6,onChange:i,onBlur:n,classes:o}),D({key:"materialCost",error:a.materialCost.error,inputLabel:"单价",inputValue:a.materialCost.value,helperText:a.materialCost.message,xs:6,unit:"元/kg",onChange:i,onBlur:n,classes:o}),D({key:"freight",error:a.freight.error,inputLabel:"运费",inputValue:a.freight.value,helperText:a.freight.message,xs:6,unit:"元",onChange:i,onBlur:n,classes:o}),D({key:"extraCost",error:!1,inputLabel:"其他费用",inputValue:a.extraCost,helperText:"",xs:6,unit:"元",onChange:i,onBlur:n,classes:o,required:!1}),D({key:"predictWeight",error:!1,inputLabel:"预估重量",inputValue:a.predictWeight,helperText:"计算公式：体积 x 密度",xs:6,unit:"kg",readOnly:!0,required:!1,onChange:i,onBlur:n,classes:o}),c.a.createElement(m.a,{fullWidth:!0,className:o.formControl},c.a.createElement(p.a,{placeholder:"备注",rows:8,onChange:function(e){return i(e,"description")},value:a.description})),Q({classes:o,onSubmit:t,loading:u}))},J=function(e){var t=e.onSubmit,a=e.formData,r=e.formOptions,n=e.onChange,l=e.onSpecificationInputBlur,u=e.loading,o=q(),i=function(e,t){n({text:e.target.value,value:e.target.value},"input",t)};return c.a.createElement("div",{className:o.container},P({formOptions:r,formData:a,classes:o,handleSelectChange:function(e,t){n({text:"",value:e.target.value},"select",t)},handleAutocompleteChange:function(e,t){n(t,"autoComplete")},handleInputChange:i,onSpecificationInputBlur:l}),D({key:"weight",error:a.weight.error,inputLabel:"实际重量",inputValue:a.weight.value,helperText:a.weight.message,xs:6,unit:"kg",onChange:i,onBlur:l,classes:o}),D({key:"height",error:a.height.error,inputLabel:"高度",inputValue:a.height.value,helperText:a.height.message,xs:6,onChange:i,onBlur:l,classes:o}),D({key:"materialQuantity",error:a.materialQuantity.error,inputLabel:"数量",inputValue:a.materialQuantity.value,helperText:a.materialQuantity.message,xs:6,unit:"个",onChange:i,onBlur:l,classes:o}),D({key:"materialCost",error:!1,inputLabel:"单价",inputValue:a.materialCost.value,helperText:"",xs:6,unit:"元/kg",readOnly:!0,required:!1,onChange:i,onBlur:l,classes:o}),D({key:"predictWeight",error:!1,inputLabel:"预估重量",inputValue:a.predictWeight,helperText:"计算公式：体积 x 密度",xs:6,unit:"kg",readOnly:!0,required:!1,onChange:i,onBlur:l,classes:o}),D({key:"costFee",error:!1,inputLabel:"据费",inputValue:a.costFee,helperText:"",xs:6,unit:"元/个",readOnly:!0,required:!1,onChange:i,onBlur:l,classes:o}),D({key:"predictPrice",error:!1,inputLabel:"预估总价",inputValue:a.predictPrice,helperText:"",xs:6,unit:"元",readOnly:!0,required:!1,onChange:i,onBlur:l,classes:o}),c.a.createElement(m.a,{fullWidth:!0,className:o.formControl},c.a.createElement(p.a,{placeholder:"备注",rows:8,onChange:function(e){return i(e,"description")},value:a.description})),Q({classes:o,onSubmit:t,loading:u}))},G=a(1500),R=a(1501),M=a(1491),H=a(1329),K=a.n(H),U=function(e,t,a,r){return new(a||(a=Promise))((function(n,l){function u(e){try{i(r.next(e))}catch(e){l(e)}}function o(e){try{i(r.throw(e))}catch(e){l(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(u,o)}i((r=r.apply(e,t||[])).next())}))},X={value:-1,error:!1,message:""},Y={value:"",error:!1,message:""};t.default=function(){var e=Object(s.useState)(!1),t=i()(e,2),a=t[0],r=t[1],l=Object(s.useState)(!1),o=i()(l,2),m=o[0],p=o[1],h=Object(s.useState)(!1),g=i()(h,2),v=g[0],d=g[1],f=Object(s.useState)([]),y=i()(f,2),x=y[0],C=y[1],b=Object(s.useState)([]),E=i()(b,2),k=E[0],T=E[1],S=Object(s.useState)([]),O=i()(S,2),j=O[0],B=O[1],I=Object(s.useState)([]),F=i()(I,2),V=F[0],L=F[1],N=Object(s.useState)(0),W=i()(N,2),q=W[0],D=W[1],P=Object(s.useState)(X),Q=i()(P,2),H=Q[0],Z=Q[1],$=Object(s.useState)(u()({},X,{value:{text:"",value:-1}})),_=i()($,2),ee=_[0],te=_[1],ae=Object(s.useState)(Y),re=i()(ae,2),ne=re[0],le=re[1],ue=Object(s.useState)(Y),oe=i()(ue,2),ie=oe[0],se=oe[1],ce=Object(s.useState)(Y),me=i()(ce,2),pe=me[0],he=me[1],ge=Object(s.useState)(Y),ve=i()(ge,2),de=ve[0],fe=ve[1],ye=Object(s.useState)(Y),xe=i()(ye,2),Ce=xe[0],be=xe[1],Ee=Object(s.useState)(),ke=i()(Ee,2),Te=ke[0],we=ke[1],Se=Object(s.useState)(Y),Oe=i()(Se,2),je=Oe[0],Be=Oe[1],Ie=Object(s.useState)(),Fe=i()(Ie,2),Ve=Fe[0],Le=Fe[1],Ne=Object(s.useState)(""),We=i()(Ne,2),qe=We[0],De=We[1],Pe=Object(s.useState)(Y),Qe=i()(Pe,2),Ae=Qe[0],ze=Qe[1],Je=Object(s.useState)(0),Ge=i()(Je,2),Re=Ge[0],Me=Ge[1],He=Object(s.useState)(0),Ke=i()(He,2),Ue=Ke[0],Xe=Ke[1],Ye=Object(s.useState)(X),Ze=i()(Ye,2),$e=Ze[0],_e=Ze[1],et=Object(s.useState)(X),tt=i()(et,2),at=tt[0],rt=tt[1];Object(s.useEffect)((function(){var e=function(e,t){return U(void 0,void 0,void 0,n.a.mark((function a(){var r,l;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("/toy/get/get-material-type?sign="+e);case 2:return r=a.sent,a.next=5,r.json();case 5:return l=a.sent,a.t0=t,a.next=9,l;case 9:a.t1=a.sent,(0,a.t0)(a.t1);case 11:case"end":return a.stop()}}),a)})))};e(1,C),e(10,B),e(9,L)}),[]);var nt=function(){var e=!1;return-1===H.value&&(Z(u()({},H,{error:!0,message:"该项不能为空"})),e=!0),""===ne.value&&(le(u()({},ne,{error:!0,message:"该项不能为空"})),e=!0),""===ie.value&&(se(u()({},ie,{error:!0,message:"该项不能为空"})),e=!0),""===pe.value&&-1!==H.value&&(he(u()({},pe,{error:!0,message:"该项不能为空"})),e=!0),""===de.value&&(fe(u()({},de,{error:!0,message:"该项不能为空"})),e=!0),""===Ce.value&&(fe(u()({},Ce,{error:!0,message:"该项不能为空"})),e=!0),""!==je.value&&(Be(u()({},je,{error:!0,message:"该项不能为空"})),e=!0),-1===$e.value&&(_e(u()({},$e,{error:!0,message:"该项不能为空"})),e=!0),-1===at.value&&(rt(u()({},at,{error:!0,message:"该项不能为空"})),e=!0),-1===ee.value.value&&te(u()({},ee,{error:!0,message:"该项不能为空"})),{hasError:e,params:{materialType:H.value,materialCost:ne.value,type:q,height:de.value,weight:Ce.value,freight:je.value,description:qe,extraCost:Ve,materialId:ee.value.value,materialQuantity:Ae.value,round:$e.value,sellType:at.value}}},lt=function(e){return U(void 0,void 0,void 0,n.a.mark((function t(){var a,r,l;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/toy/get/get-detail?materialType="+e);case 2:return a=t.sent,t.next=5,a.json();case 5:r=t.sent,l=[],r.map((function(e){l.push({value:e.id,text:e["材质"],costFee:e["锯费"],materialCost:e["单价"],length:e["长"],width:e["宽"]})})),T(l);case 9:case"end":return t.stop()}}),t)})))},ut=function(){d(!1),p(!1),r(!1),Z(X),te(u()({},X,{value:{text:"",value:-1}})),le(Y),se(Y),he(Y),fe(Y),be(Y),we(""),Be(Y),Le(""),De(""),ze(Y),Me(0),Xe(0),rt(X),_e(X)},ot={materialType:H,materialId:ee,materialCost:ne,type:q,length:ie,width:pe,height:de,weight:Ce,predictWeight:Te,freight:je,extraCost:Ve,description:qe,round:$e,sellType:at},it={loading:a,onSubmit:function(){return U(void 0,void 0,void 0,n.a.mark((function e(){var t,a,l,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=nt(),a=t.hasError,l=t.params,!a){e.next=3;break}return e.abrupt("return");case 3:return r(!0),e.next=6,fetch("/toy/good/in",{body:JSON.stringify(l),method:"POST",headers:{"Content-Type":"application/json"}});case 6:return u=e.sent,e.next=9,u.text();case 9:return"success"===e.sent?p(!0):d(!0),e.abrupt("return",l);case 12:case"end":return e.stop()}}),e)})))},formOptions:{materialType:x,materialId:k,roundType:j,sellType:V},onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{value:"",text:""},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,r={value:e.value,error:""===e.value,message:""===e.value?"该项不能为空":""},n={materialCost:function(){le(r)},freight:function(){Be(r)},extraCost:function(){Le(e.value)},description:function(){De(e.value)},length:function(){se(r)},width:function(){he(r)},height:function(){fe(r)},weight:function(){be(r)},predictWeight:function(){},materialQuantity:function(){ze(r)},costFee:function(){},predictPrice:function(){}},l={materialType:function(){return Z(u()({},H,{value:e.value}))},roundType:function(){return _e(u()({},$e,{value:e.value}))},sellType:function(){return rt(u()({},at,{value:e.value}))}};switch(t){case"input":n[a]();break;case"select":-1!==e.value&&lt(e.value),l[a]();break;case"autoComplete":Me(e?e.costFee:0),le({value:e?e.materialCost:0,error:!1,message:""}),te(u()({value:{text:e.text,value:e.value},error:!e.value,message:e.value?"":"该项不能为空"}))}},onSpecificationInputBlur:function(){!function(e){var t=e*parseFloat(ne.value)+parseFloat(Ae.value)*Re;Xe(parseFloat(t.toFixed(1)))}(function(e,t,a,r,n){0!==n||r||(r=1);var l=function(e,t,a){var n=Math.PI*e*e;return t&&(n=e*t),parseFloat((n*a*7.874/1e3*r).toFixed(2))}(e/2/10,t/10,a/10);return e&&a?we(l):e&&t&&a&&we(l),l}(parseFloat(ie.value),parseFloat(pe.value),parseFloat(de.value),parseFloat(Ae.value),q))}};return c.a.createElement(c.a.Fragment,null,c.a.createElement(G.a,{position:"static"},c.a.createElement(R.a,null,c.a.createElement(w.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){return D(0===q?1:0)}},c.a.createElement(K.a,null)),c.a.createElement(M.a,{variant:"h6"},q?"出库":"入库"))),A({type:"success",message:"保存成功",open:m,onClose:ut}),A({type:"failed",message:"保存失败",open:v,onClose:ut}),q?c.a.createElement(J,u()({formData:u()({},ot,{materialQuantity:Ae,costFee:Re,predictPrice:Ue})},it)):c.a.createElement(z,u()({formData:ot},it)))}}}]);